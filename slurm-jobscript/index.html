
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This documet covers vide range of topics from detailed description of hardware infrastructure to the information required to utilize the Madhava HPC Cluster installed in CCMS, NIT Calicut effectively ">
      
      
        <meta name="author" content="CCMS NITC">
      
      
      <link rel="icon" href="../assets/logo_black.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.7">
    
    
      
        <title>Slurm Job Scipt - Centre for Computational Modelling and Simulation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/termynal.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link rel="stylesheet" href="../overrides/assets/stylesheets/main.c1d34250.min.css">
  <link rel="stylesheet" href="../overrides/stylesheets/global.css">



  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#slurm-job-script" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  <span class="title">NEWS</span>
  <div class="marquee">
    <ul class="marquee-content" id="news-container">
    </ul>
  </div>
      <script src="../assets/js/news.js"></script>
      <script type="text/javascript">
        loadNews("../news.json")
      </script>

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Centre for Computational Modelling and Simulation" class="md-header__button md-logo" aria-label="Centre for Computational Modelling and Simulation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Centre for Computational Modelling and Simulation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Slurm Job Scipt
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../getting-started/" class="md-tabs__link">
        Getting started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../softwares/" class="md-tabs__link">
        Softwares
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../slurm/" class="md-tabs__link md-tabs__link--active">
        Slurm Job Scheduler
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../storage/" class="md-tabs__link">
        Data & Storage
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../contact_us/" class="md-tabs__link">
      Contact Us
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Centre for Computational Modelling and Simulation" class="md-nav__button md-logo" aria-label="Centre for Computational Modelling and Simulation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    Centre for Computational Modelling and Simulation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../system_configuration/" class="md-nav__link">
        System Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pol-practice/" class="md-nav__link">
        Be a Good Cluster Citizen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../job-schedule-manage/" class="md-nav__link">
        Job Scheduling and Managing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Softwares
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Softwares" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Softwares
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../softwares/" class="md-nav__link">
        Software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../envmod/" class="md-nav__link">
        Environment Modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../software-catalog/" class="md-nav__link">
        Software Catalog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Slurm Job Scheduler
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Slurm Job Scheduler" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Slurm Job Scheduler
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../slurm/" class="md-nav__link">
        Slurm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pnq/" class="md-nav__link">
        Partition & Qos
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Slurm Job Script
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Slurm Job Script
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sample-job-script" class="md-nav__link">
    Sample job script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-job-directives" class="md-nav__link">
    SLURM Job Directives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-serial-single-threaded-jobs-using-a-cpu-on-a-node" class="md-nav__link">
    Running Serial / Single Threaded Jobs using a CPU on a node
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-multi-threaded-jobs-using-multiple-cpu-cores-on-a-node" class="md-nav__link">
    Running Multi-threaded Jobs using multiple CPU cores on a node
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-mpi-jobs-using-multiple-nodes" class="md-nav__link">
    Running MPI jobs using multiple nodes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-hybrid-openmpmpi-jobs-using-multiple-nodes" class="md-nav__link">
    Running hybrid OpenMP/MPI jobs using multiple nodes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-jobs-using-gpu" class="md-nav__link">
    Running jobs using GPU
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../job-array/" class="md-nav__link">
        Slurm Job Arrays
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../job-depend/" class="md-nav__link">
        Slurm Job Dependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../submit/" class="md-nav__link">
        Slurm Job Submission
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../slurm-manage/" class="md-nav__link">
        Slurm Job Management
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Data & Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data & Storage" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Data & Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../transfer/" class="md-nav__link">
        Transfering Files In & Out
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contact_us/" class="md-nav__link">
        Contact Us
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="slurm-job-script"><strong>SLURM Job script</strong><a class="headerlink" href="#slurm-job-script" title="Permanent link">&para;</a></h1>
<p>To execute a program in the cluster system, a user has to write a batch script and submit it to the SLURM job scheduler. Sample of general SLURM scripts are located in each user’s hpc2021 home directory ~/slurm-samples and user guide for individual software can be referenced.</p>
<h2 id="sample-job-script">Sample job script<a class="headerlink" href="#sample-job-script" title="Permanent link">&para;</a></h2>
<p>In the example job script (script.cmd) below, it requests the following resources and actual programs/commands to be executed.</p>
<ul>
<li>Name the job as “pilot_study” for easy reference.</li>
<li>Request for the “shortq” partition</li>
<li>Request for “shortq” QoS.</li>
<li>Request for allocation of 40 CPU cores contributed from a total of one compute node.</li>
<li>Request for 10GB physical RAM.</li>
<li>Request for job execution 3 days and 10 hours ( The job would be terminated by SLURM after the specified amount of time no matter it has finished or not).
    Write the standard output and standard error to the file “pilot_study_2021.out” and “pilot_study_2021.err” respectively under the folder where the job is submitted. The path supports the use of replacement symbols.<pre><code>    #!/bin/bash
    #SBATCH --job-name=pilot_study        # 1. Job name 
    #SBATCH --partition=shortq            # 2. Request a partition
    #SBATCH --ntasks=40                   # 3. Request total number of tasks (MPI workers)
    #SBATCH --nodes=1                     # 4. Request number of node(s)
    #SBATCH --mem=10G                     # 5. Request total amount of RAM
    #SBATCH --time=3-10:00:00             # 6. Job execution duration limit day-hour:min:sec
    #SBATCH --output=%x_%j.out            # 7. Standard output log as $job_name_$job_id.out
    #SBATCH --error=%x_%j.err             # 8. Standard error log as $job_name_$job_id.err

    ##print the start time
    date
    command1 ...
    command2 ...
    command3 ...
    ##print the end time
    date
</code></pre>
</li>
</ul>
<h2 id="slurm-job-directives">SLURM Job Directives<a class="headerlink" href="#slurm-job-directives" title="Permanent link">&para;</a></h2>
<p>A SLURM script includes a list of SLURM job directives at the top of the file, where each line starts with #SBATCH followed by option name to value pairs to tell the job scheduler the resources that a job requests.</p>
<table>
<thead>
<tr>
<th>Long Option</th>
<th>Short Option</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>--job-name</td>
<td>-J</td>
<td>file name of job script</td>
<td>User defined name to identify a job</td>
</tr>
<tr>
<td>--partition</td>
<td>-p</td>
<td>intel</td>
<td>Partition where a job to be executed</td>
</tr>
<tr>
<td>--time</td>
<td>-t</td>
<td>24:00:00</td>
<td>Specify a limit on the maximum execution time (walltime) for the job (D-HH:MM:SS) .For example, -t 1- is one day, -t 6:00:00 is 6 hours</td>
</tr>
<tr>
<td>--nodes</td>
<td>-N</td>
<td></td>
<td>Total number of node(s)</td>
</tr>
<tr>
<td>--ntasks</td>
<td>-n</td>
<td>1</td>
<td>Number of tasks (MPI workers)</td>
</tr>
<tr>
<td>--ntasks-per-node</td>
<td></td>
<td></td>
<td>Number of tasks per node</td>
</tr>
<tr>
<td>--cpus-per-task</td>
<td>-c</td>
<td>1</td>
<td>Number of CPUs required per task</td>
</tr>
<tr>
<td>--mem</td>
<td></td>
<td></td>
<td>Amount of memory allocated per node. Different units can be specified using the suffix [K</td>
</tr>
<tr>
<td>--mem-per-cpu</td>
<td></td>
<td></td>
<td>Amount of memory allocated per cpu per code (For multicore jobs). Different units can be specified using the suffix [K</td>
</tr>
<tr>
<td>--exclude</td>
<td>-x</td>
<td></td>
<td>Explicitly exclude certain nodes from the resources granted to the job.</td>
</tr>
</tbody>
</table>
<p>More SLURM directives are available <a href="https://slurm.schedmd.com/pdfs/summary.pdf">here</a></p>
<h2 id="running-serial-single-threaded-jobs-using-a-cpu-on-a-node">Running Serial / Single Threaded Jobs using a CPU on a node<a class="headerlink" href="#running-serial-single-threaded-jobs-using-a-cpu-on-a-node" title="Permanent link">&para;</a></h2>
<p>Serial or single CPU core jobs are those jobs that can only make use of one CPU on a node. A SLURM batch script below will request for a single CPU on a node with default amount of RAM  for 30 minutes in testq partition.</p>
<pre><code>        #!/bin/bash
        #SBATCH --job-name=test-job1         
        #SBATCH --ntasks=1
        #SBATCH --partition=shortq            
        #SBATCH --time=00:30:00

        command1 ...
</code></pre>
<h2 id="running-multi-threaded-jobs-using-multiple-cpu-cores-on-a-node">Running Multi-threaded Jobs using multiple CPU cores on a node<a class="headerlink" href="#running-multi-threaded-jobs-using-multiple-cpu-cores-on-a-node" title="Permanent link">&para;</a></h2>
<p>For those jobs that can leverage multiple CPU cores on a node via creating multiple threads within a process (e.g. OpenMP), a SLURM batch script below may be used that requests for allocation to a task with 8 CPU cores on a single node and 6GB RAM per core (Totally 6GB x 8 = 48GB RAM on a node ) for 1 hour in shortq partition.</p>
<div class="admonition info">
<p class="admonition-title">Note<p>--cpus-per-task should be no more than the number of cores on a compute node you request. You may want to experiment with the number of threads for your job to determine the optimal number, as computational speed does not always increase with more threads. Note that if --cpus-per-task is fewer than the number of cores on a node, your job will not make full use of the node.</p>
</p>
</div>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>For program that can only use a single CPU, requesting for more CPU will NOT make it run faster but will likely make the queuing time longer.</p>
</div>
<p>eg:</p>
<pre><code>    #!/bin/bash
    #SBATCH --job-name=pilot_study       
    #SBATCH --partition=shortq            
    #SBATCH --ntasks=1                   
    #SBATCH --nodes=1                    
    #SBATCH --mem-percpu=6G                     
    #SBATCH --time=01:00:00             
    #SBATCH --cpus-per-task=8

    #For jobs supporting OpenMP, assign the value of the requested CPU cores to the OMP_NUM_THREADS variable
    #that would be automatically passed to your command supporting OpenMP

    export OMP_NUM_THREADS=${SLURM_CPUS_PER_TASK}
    command1 ...
    #For jobs not supporting OpenMP, supply the value of the requested CPU cores as command-line argument to the command
    command2 -t ${SLURM_CPUS_PER_TASK} ...
</code></pre>
<h2 id="running-mpi-jobs-using-multiple-nodes">Running MPI jobs using multiple nodes<a class="headerlink" href="#running-mpi-jobs-using-multiple-nodes" title="Permanent link">&para;</a></h2>
<p>Message Passing Interface (MPI) is a standardized and portable message-passing standard designed to allow for execution of programs using CPUs on multiple nodes where CPUs across nodes communicate over the network. The MPI standard defines the syntax and semantics of library routines that are useful to a wide range of users writing portable message-passing programs in C, C++, and Fortran. Intel MPI and OpenMPI are available in Madhava HPC system and SLURM jobs may make use of either MPI implementations.</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>Requesting for multiple nodes and /or loading any MPI modules may not necessarily make your code faster, your code must be MPI aware to use MPI. Even though running a non-MPI code with mpirun might possibly succeed, you will most likely have every core assigned to your job running the exact computation, duplicating each others work, and wasting resources.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>The version of the MPI commands you run must match the version of the MPI library used in compiling your code, or your job is likely to fail. And the version of the MPI daemons started on all the nodes for your job must also match. For example, an MPI program compiled with Intel MPI compilers should be executed using Intel MPI runtime instead of Open MPI runtime.</p>
</div>
<p>A SLURM batch script below requests for allocation to 40 tasks (MPI processes) each use a single core from two nodes and 3GB RAM per core for 1 hour in mediumq</p>
<pre><code>        #!/bin/bash
        #SBATCH --job-name=run_mpi        
        #SBATCH --partition=mediumq            
        #SBATCH --ntasks=40                   
        #SBATCH --nodes=2                     
        #SBATCH --mem=10G                     
        #SBATCH --time=01:00:00 
        #SBATCH --cpus-per-task=1
        #SBATCH --mem-per-cpu=3G            
        #SBATCH --output=%x_%j.out           
        #SBATCH --error=%x_%j.err

        cd ${SLURM_SUBMIT_DIR}
        #Load the environment for Intel MPI
        module load compilers/intel/parallel_studio_xe_2020.4.912

        #run the program supporting MPI with the "mpirun" command
        #The -n option is not required since mpirun will automatically determine from SLURM settings
        mpirun ./program_mpi
</code></pre>
<p>This example make use of all the cores on two, 20-core nodes in the “mediumq” partition. If same number of tasks (i.e. 64) is requested from partition “amd”, you should set “--nodes=1” so that all 64 cores will be allocated from a single AMD (64-core or 128-core) node . Otherwise, SLURM will assign 64 CPUs from 2 compute nodes which would induce unnecessary inter-node communication overhead.</p>
<h2 id="running-hybrid-openmpmpi-jobs-using-multiple-nodes">Running hybrid OpenMP/MPI jobs using multiple nodes<a class="headerlink" href="#running-hybrid-openmpmpi-jobs-using-multiple-nodes" title="Permanent link">&para;</a></h2>
<p>For those jobs that support both OpenMP and MPI, a SLURM batch script may specify the number of MPI tasks to run and the number of CPU core that each task should use. A SLURM batch script below requests for allocation of 2 nodes and 80 CPU cores in total for 1 hour in mediumq. Each compute node runs 2 MPI tasks, where each MPI task uses 20 CPU core and each core uses  3GB RAM. This would make use of all the cores on two, 40-core nodes in the “intel” partition.</p>
<pre><code>    #!/bin/bash
    #SBATCH --nodes=2
    #SBATCH --ntasks-per-node=2
    #SBATCH --cpus-per-task=20
    #SBATCH --mem-per-cpu=3G
    #SBATCH --time=01:00:00

    cd ${SLURM_SUBMIT_DIR}
    #Load the environment for Intel MPI
    module load compilers/intel/parallel_studio_xe_2020.4.912

    #assign the value of the requested CPU cores per task to the OMP_NUM_THREADS variable
    export OMP_NUM_THREADS=${SLURM_CPUS_PER_TASK}

    # run the program supporting MPI with the "mpirun" command.
    # The -n option is not required since mpirun will automatically determine from SLURM settings
    mpirun ./program_mpi-omp
</code></pre>
<p>Sample MPI &amp; hybrid MPI/OpenMP codes and the corresponding SLURM scripts are available at.............................</p>
<h2 id="running-jobs-using-gpu">Running jobs using GPU<a class="headerlink" href="#running-jobs-using-gpu" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>❗Your code must be GPU aware to benefit from nodes with GPU, otherwise other partition without GPU should be used.</p>
</div>
<p>A SLURM batch script below request for 8 CPU cores and 2 GPU cards from one compute node in the “gpuq” partition</p>
<pre><code>    #!/bin/bash
    #SBATCH --job-name=run_gpu        
    #SBATCH --partition=gpuq            
    #SBATCH --ntasks=1                   
    #SBATCH --nodes=1
    #SBATCH --cpus-per-task=8

    ## Load the environment module for Nvidia CUDA
    module load compilers/nvidia/cuda/11.0

    commands
</code></pre>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../pnq/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Partition &amp; Qos" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Partition & Qos
            </div>
          </div>
        </a>
      
      
        
        <a href="../job-array/" class="md-footer__link md-footer__link--next" aria-label="Next: Slurm Job Arrays" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Slurm Job Arrays
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.tabs.link", "navigation.expand", "navigation.sections", "navigation.tabs", "navigation.top", "search.highlight", "search.suggest", "toc.integrate"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8492ddcf.min.js"></script>
      
        <script src="../assets/js/termynal.js"></script>
      
        <script src="../assets/js/custom.js"></script>
      
    
  </body>
</html>